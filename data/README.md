# 数据目录说明

## 目录用途

这个目录用于存放每日新增的Excel签单清单文件。

## 使用方法

### 1. 放置文件

每天将新的Excel签单清单文件复制到这个目录:

```
data/
├── 2025-11-06_签单清单.xlsx     ← 放在这里
├── 签单清单_20251106.xlsx      ← 或这里
└── 车险清单.xlsx                ← 文件名任意
```

### 2. 刷新数据

打开网页,点击"刷新数据"按钮,系统会:
- 自动读取这个目录的所有Excel文件
- 转换为CSV格式
- 合并到主数据文件
- 移动已处理文件到 `processed/` 子目录

### 3. 查看已处理文件

处理完成的文件会移动到:

```
data/processed/
└── 2025-11-06_签单清单_processed_20251106_141230.xlsx
```

## Excel文件要求

### ✅ 必须包含的字段

- 刷新时间
- 投保确认时间
- 保险起期
- 成都中支
- 三级机构
- 保单号
- 险种大类
- 险种名称
- 是否续保
- 业务员
- 签单/批改保费
- 签单数量
- 手续费
- 手续费含税

### ✅ 支持的格式

- `.xlsx` (推荐,Excel 2007+)
- `.xls` (Excel 2003)

### ❌ 不支持的格式

- `.csv` (请用Excel格式)
- `.txt`
- 损坏的文件

## 注意事项

⚠️ **重要提示:**

1. **不要手动编辑CSV**: 合并后的CSV文件由系统自动维护
2. **备份原始文件**: 建议保留Excel原始文件的备份
3. **文件命名**: 可以使用任意文件名,系统会自动识别
4. **重复数据**: 系统会根据"保单号+投保确认时间"自动去重

## 示例数据

如果你是第一次使用,可以将现有的合并CSV文件作为基础:

```
项目根目录/
└── 车险清单_2025年10-11月_合并.csv  ← 已有的历史数据
```

新增数据会自动追加到这个文件中。

## 故障排查

### 刷新后没有数据?

检查:
1. ✅ 文件是否在 `data/` 目录(不是子目录)
2. ✅ 文件扩展名是 `.xlsx` 或 `.xls`
3. ✅ 文件可以正常用Excel打开
4. ✅ 文件包含必需的字段

### 处理速度慢?

- 单个Excel文件超过5MB可能需要10-30秒
- 一次处理多个大文件可能需要更长时间
- 这是正常的,请耐心等待

### 文件丢失?

- 已处理的文件在 `data/processed/` 目录
- 系统不会删除文件,只会移动
- 如果需要重新处理,可以将文件移回 `data/` 目录

---

**准备好了吗?** 将你的Excel文件放到这个目录,然后点击网页上的"刷新数据"按钮! 🚀
