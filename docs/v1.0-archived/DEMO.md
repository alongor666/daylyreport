# 系统演示指南

## 准备工作(5分钟)

### 1. 确认环境

打开命令行,检查Python版本:

```bash
python --version
```

应该显示 Python 3.8 或更高版本。

### 2. 安装依赖

```bash
cd "d:\WPS+iMac\车险签单清单_2025年3月\daylyreport"
pip install -r requirements.txt
```

等待安装完成(约1-2分钟)。

### 3. 启动服务器

双击运行: `start_server.bat`

或在命令行执行:

```bash
start_server.bat
```

看到以下输出表示成功:

```
========================================
 服务器地址: http://localhost:5000
 网页访问: http://localhost:5000/static/index.html
========================================
```

---

## 演示流程(10分钟)

### 场景1: 查看日报数据(2分钟)

1. **打开浏览器**
   - 访问: http://localhost:5000
   - 或访问: http://localhost:5000/static/index.html

2. **观察页面加载**
   - 页面显示"加载中..."动画
   - 约2-3秒后显示完整数据

3. **查看KPI卡片**

   页面顶部显示4个KPI:

   ```
   ┌──────────────┐  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐
   │ 💰 签单总保费 │  │ 📋 保单件数   │  │ 💵 手续费     │  │ 🎯 目标差距   │
   │              │  │              │  │              │  │              │
   │ ¥125,678.90 │  │    234       │  │ ¥5,027.16   │  │ ¥-74,321.10 │
   │ 日期: 11-05  │  │ 日期: 11-05  │  │ 日期: 11-05  │  │ ↓ 未达目标   │
   └──────────────┘  └──────────────┘  └──────────────┘  └──────────────┘
   ```

4. **解读数据**
   - 签单总保费: 当日所有保单的保费总和
   - 保单件数: 当日签单的保单数量
   - 手续费: 当日手续费总额
   - 目标差距: 与20万目标的差距(红色表示未完成)

---

### 场景2: 查看7天趋势(3分钟)

1. **观察趋势图**

   页面中部显示柱状图:

   ```
   📈 签单保费趋势对比

   ┌─────────────────────────────────────────┐
   │                                         │
   │     ▄▄▄                     ▄▄▄        │
   │    █████        ▄▄▄        █████       │
   │   ██████▄▄▄   ██████      ██████       │
   │  ████████████ ████████▄▄▄████████      │
   │ ─────────────────────────────────────  │
   │ 周五 周六 周日 周一 周二 周三 周四     │
   └─────────────────────────────────────────┘
   ```

2. **交互操作**
   - 🖱️ 鼠标悬停在柱子上
   - 显示详细tooltip:
     ```
     周四
     签单保费: ¥125,678.90
     保单件数: 234 件
     ```

3. **观察趋势**
   - 哪天保费最高?
   - 哪天件数最多?
   - 是否有明显的周期性规律?

---

### 场景3: 切换到3周视图(2分钟)

1. **点击切换按钮**

   在图表上方找到:

   ```
   [ 近7天 ]  [ 近3周 ]
      ↑点这里    ↑点这里
   ```

2. **点击"近3周"按钮**
   - 图表自动切换
   - 显示21天的数据
   - X轴变长,显示3周的周几

3. **对比观察**
   - 整体趋势是上升还是下降?
   - 哪一周表现最好?
   - 是否有异常数据点?

---

### 场景4: 刷新数据(3分钟)

#### 4.1 准备测试数据

为了演示,我们使用现有的CSV文件:

```bash
# 复制现有CSV文件作为测试数据
copy "车险清单_2025年10-11月_合并.csv" "data\test_data.xlsx"
```

注意: 实际使用时应该是真实的Excel文件。

#### 4.2 点击刷新按钮

1. 找到页面右上角的按钮:
   ```
   [ 🔄 刷新数据 ]
   ```

2. 点击按钮

3. 观察反馈:
   - 显示"数据加载中..."动画
   - 约2-5秒后弹出提示: "数据刷新成功!"
   - KPI卡片自动更新
   - 趋势图自动重绘

#### 4.3 查看处理结果

打开 `data/processed/` 目录:

```
data/processed/
└── test_data_processed_20251106_141523.xlsx
```

文件已被移动到这里,表示处理完成。

---

## 演示要点

### 展示的核心功能

✅ **自动数据处理**
- Excel自动转CSV
- 数据自动清洗
- 重复数据去重
- 历史数据合并

✅ **日报KPI展示**
- 4个核心指标
- 实时计算
- 目标完成情况

✅ **趋势可视化**
- 双Y轴图表
- 7天/3周切换
- 动态X轴显示
- 交互式查看

✅ **用户友好**
- 一键刷新
- 自动更新
- 现代化界面
- 响应式设计

---

## 演示脚本(讲解)

### 开场(30秒)

> "大家好,今天给大家演示一个车险签单数据分析系统。这个系统可以帮助我们快速查看每日的签单情况,并分析最近的趋势。"

### 功能介绍(2分钟)

> "首先看页面顶部,这是4个核心KPI指标:"
>
> "第一个是签单总保费,显示当日的保费总额,这里是12万多。"
>
> "第二个是保单件数,今天一共签了234单。"
>
> "第三个是手续费,总共5000多元。"
>
> "第四个是目标差距,我们设定的日目标是20万,今天还差7万多,所以显示红色未达标。"

### 趋势分析(3分钟)

> "下面这个图表展示了最近7天的签单保费趋势。"
>
> "注意X轴显示的是周几,而不是具体日期。这样更直观,可以看出周几的业绩比较好。"
>
> "蓝色的柱子是签单保费,左边Y轴。粉色的折线是保单件数,右边Y轴。"
>
> "我们可以鼠标悬停在柱子上,查看详细数据。"
>
> (操作演示悬停)
>
> "如果想看更长周期的趋势,可以点击'近3周'按钮。"
>
> (点击切换)
>
> "现在可以看到21天的数据,整体趋势一目了然。"

### 数据更新(2分钟)

> "系统最强大的功能是自动处理新数据。"
>
> "每天只需要把新的Excel签单清单文件放到data目录,然后点击'刷新数据'按钮。"
>
> (点击刷新)
>
> "系统会自动读取Excel文件,清洗数据,合并到历史数据中,并自动去重。"
>
> "处理完成后,页面会自动更新最新的数据。"
>
> "已处理的文件会自动移动到processed目录归档,不会丢失。"

### 总结(1分钟)

> "总结一下,这个系统有三大优势:"
>
> "1. 全自动: Excel文件自动处理,无需手动操作"
>
> "2. 实时性: 数据实时刷新,KPI实时计算"
>
> "3. 可视化: 直观的图表展示,趋势一目了然"
>
> "系统已经部署好,大家可以立即使用。有任何问题欢迎随时反馈。"

---

## 常见问题演示

### Q1: 如果没有数据怎么办?

**演示步骤:**
1. 删除CSV文件(或重命名)
2. 刷新页面
3. 显示"暂无数据"
4. 引导用户放入Excel文件并刷新

### Q2: 如何查看历史数据?

**演示步骤:**
1. 打开CSV文件(用Excel或记事本)
2. 展示数据结构
3. 说明可以直接查询或导出

### Q3: 目标值可以修改吗?

**演示步骤:**
1. 打开 `backend/data_processor.py`
2. 找到 `daily_target = 200000`
3. 修改为需要的值
4. 重启服务器
5. 刷新页面,验证生效

---

## 演示检查清单

开始演示前确认:

- [ ] Python环境正常
- [ ] 依赖已安装
- [ ] 服务器已启动
- [ ] 浏览器已打开
- [ ] 有测试数据文件
- [ ] 网络连接正常(加载ECharts)

演示过程注意:

- [ ] 语速适中,清晰表达
- [ ] 操作流畅,避免卡顿
- [ ] 重点功能多次强调
- [ ] 实时关注听众反应
- [ ] 预留提问时间

---

## 演示后的行动

1. **收集反馈**
   - 记录用户的意见和建议
   - 了解实际使用场景
   - 发现潜在问题

2. **快速修复**
   - 修复演示中发现的bug
   - 优化用户体验
   - 完善文档说明

3. **持续改进**
   - 根据反馈调整功能
   - 增加新的需求
   - 提升系统性能

---

**祝演示成功!** 🎉

如有问题,随时查看:
- [README.md](README.md) - 项目文档
- [USAGE_GUIDE.md](USAGE_GUIDE.md) - 使用指南
- [PROJECT_SUMMARY.md](PROJECT_SUMMARY.md) - 项目总结
