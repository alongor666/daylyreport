======================================================================
🚀 车险签单数据分析平台 - REST API Server
======================================================================

📡 API服务地址: http://localhost:5001
🌐 前端开发服务器: http://localhost:3000 (使用 'npm run dev' 启动)

======================================================================

📋 可用API接口:
  POST /api/refresh          - 刷新数据(处理新Excel)
  POST /api/kpi-windows      - 获取KPI三口径数据
  POST /api/week-comparison  - 获取周对比图表数据
  GET  /api/filter-options   - 获取筛选选项
  GET  /api/daily-report     - 获取日报
  GET  /api/week-trend       - 获取周趋势
  GET  /api/latest-date      - 获取最新日期
  GET  /api/health           - 健康检查

======================================================================

💡 开发提示:
  - 前端开发: 访问 http://localhost:3000
  - API测试: 可使用 curl/Postman 访问上述接口
  - 数据目录: backend/车险日报/

======================================================================

 * Serving Flask app 'api_server'
 * Debug mode: on
[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5001
 * Running on http://192.168.31.210:5001
[33mPress CTRL+C to quit[0m
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 103-048-207
127.0.0.1 - - [09/Nov/2025 11:03:39] "GET /api/health HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:03:49] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:03:57] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:04:04] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:10:38] "GET /api/filter-options HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:10:39] "GET /api/policy-mapping HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:10:39] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:10:39] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:10:47] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:10:48] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:11:17] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:11:17] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:11:56] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:11:56] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:12:04] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:12:04] "POST /api/week-comparison HTTP/1.1" 200 -
 * Detected change in '/Users/xuechenglong/Desktop/签单日报(家)__daylyreport/backend/data_processor.py', reloading
======================================================================
🚀 车险签单数据分析平台 - REST API Server
======================================================================

📡 API服务地址: http://localhost:5001
🌐 前端开发服务器: http://localhost:3000 (使用 'npm run dev' 启动)

======================================================================

📋 可用API接口:
  POST /api/refresh          - 刷新数据(处理新Excel)
  POST /api/kpi-windows      - 获取KPI三口径数据
  POST /api/week-comparison  - 获取周对比图表数据
  GET  /api/filter-options   - 获取筛选选项
  GET  /api/daily-report     - 获取日报
  GET  /api/week-trend       - 获取周趋势
  GET  /api/latest-date      - 获取最新日期
  GET  /api/health           - 健康检查

======================================================================

💡 开发提示:
  - 前端开发: 访问 http://localhost:3000
  - API测试: 可使用 curl/Postman 访问上述接口
  - 数据目录: backend/车险日报/

======================================================================

警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 9 名业务员在数据中存在但在映射文件中未找到:
  - 110069270孙永胜
  - 110070904宋春建
  - 110072851曾志超
  - 200045611张俊容
  - 200046585刘洋新
  - 200050681张彩云
  - 200053075王思东
  - 200053364李颜
  - 210011890陶丽
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 9 名业务员在数据中存在但在映射文件中未找到:
  - 110069270孙永胜
  - 110070904宋春建
  - 110072851曾志超
  - 200045611张俊容
  - 200046585刘洋新
  - 200050681张彩云
  - 200053075王思东
  - 200053364李颜
  - 210011890陶丽
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 4 名业务员在数据中存在但在映射文件中未找到:
  - 110069270孙永胜
  - 110070904宋春建
  - 110072851曾志超
  - 200045611张俊容
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 73 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110024535彭伟
  - 110030687黎蓓
  - 110035644唐斌
  - 110037882魏晓军
  - 110051238潘小琼
  - 110051866罗平
  - 110052052官久强
  - 110052422赵波
  - 110056772周仕钦
  ... 还有 63 个
警告: 以下 73 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110024535彭伟
  - 110030687黎蓓
  - 110035644唐斌
  - 110037882魏晓军
  - 110051238潘小琼
  - 110051866罗平
  - 110052052官久强
  - 110052422赵波
  - 110056772周仕钦
  ... 还有 63 个
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 3 名业务员在数据中存在但在映射文件中未找到:
  - 110063396陈昱舟
  - 200047069杨敏
  - 210011833周勇
警告: 以下 3 名业务员在数据中存在但在映射文件中未找到:
  - 110063396陈昱舟
  - 200047069杨敏
  - 210011833周勇
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 73 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110024535彭伟
  - 110030687黎蓓
  - 110035644唐斌
  - 110037882魏晓军
  - 110051238潘小琼
  - 110051866罗平
  - 110052052官久强
  - 110052422赵波
  - 110056772周仕钦
  ... 还有 63 个
警告: 以下 73 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110024535彭伟
  - 110030687黎蓓
  - 110035644唐斌
  - 110037882魏晓军
  - 110051238潘小琼
  - 110051866罗平
  - 110052052官久强
  - 110052422赵波
  - 110056772周仕钦
  ... 还有 63 个
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 222 名业务员在数据中存在但在映射文件中未找到:
  - 110009223黄艳
  - 110009277罗利娟
  - 110015604曾世强
  - 110018010胥霞
  - 110021087杨秀红
  - 110023646李志蓉
  - 110024535彭伟
  - 110027511王晓渝
  - 110028772游峰
  - 110028823李兴
  ... 还有 212 个
警告: 以下 12 名业务员在数据中存在但在映射文件中未找到:
  - 110067438彭高荣
  - 200046053廖荣秋
  - 200046092张丽
  - 200051155罗磊
  - 200052588李珊
  - 210000273李孝林
  - 210011886张湖川
  - 210011887杨占军
  - 210011896乔军
  - 210011923彭明宇
  ... 还有 2 个
警告: 以下 12 名业务员在数据中存在但在映射文件中未找到:
  - 110067438彭高荣
  - 200046053廖荣秋
  - 200046092张丽
  - 200051155罗磊
  - 200052588李珊
  - 210000273李孝林
  - 210011886张湖川
  - 210011887杨占军
  - 210011896乔军
  - 210011923彭明宇
  ... 还有 2 个
 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 103-048-207
 * Detected change in '/Users/xuechenglong/Desktop/签单日报(家)__daylyreport/backend/api_server.py', reloading
======================================================================
🚀 车险签单数据分析平台 - REST API Server
======================================================================

📡 API服务地址: http://localhost:5001
🌐 前端开发服务器: http://localhost:3000 (使用 'npm run dev' 启动)

======================================================================

📋 可用API接口:
  POST /api/refresh          - 刷新数据(处理新Excel)
  POST /api/kpi-windows      - 获取KPI三口径数据
  POST /api/week-comparison  - 获取周对比图表数据
  GET  /api/filter-options   - 获取筛选选项
  GET  /api/daily-report     - 获取日报
  GET  /api/week-trend       - 获取周趋势
  GET  /api/latest-date      - 获取最新日期
  GET  /api/health           - 健康检查

======================================================================

💡 开发提示:
  - 前端开发: 访问 http://localhost:3000
  - API测试: 可使用 curl/Postman 访问上述接口
  - 数据目录: backend/车险日报/

======================================================================

 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 103-048-207
 * Detected change in '/Users/xuechenglong/Desktop/签单日报(家)__daylyreport/backend/api_server.py', reloading
======================================================================
🚀 车险签单数据分析平台 - REST API Server
======================================================================

📡 API服务地址: http://localhost:5001
🌐 前端开发服务器: http://localhost:3000 (使用 'npm run dev' 启动)

======================================================================

📋 可用API接口:
  POST /api/refresh          - 刷新数据(处理新Excel)
  POST /api/kpi-windows      - 获取KPI三口径数据
  POST /api/week-comparison  - 获取周对比图表数据
  GET  /api/filter-options   - 获取筛选选项
  GET  /api/daily-report     - 获取日报
  GET  /api/week-trend       - 获取周趋势
  GET  /api/latest-date      - 获取最新日期
  GET  /api/health           - 健康检查

======================================================================

💡 开发提示:
  - 前端开发: 访问 http://localhost:3000
  - API测试: 可使用 curl/Postman 访问上述接口
  - 数据目录: backend/车险日报/

======================================================================

 * Restarting with stat
 * Debugger is active!
 * Debugger PIN: 103-048-207
127.0.0.1 - - [09/Nov/2025 11:28:42] "GET /api/filter-options HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:28:43] "GET /api/policy-mapping HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:28:43] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:28:43] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:28:58] "GET /api/filter-options HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:28:58] "GET /api/policy-mapping HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:28:58] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:28:59] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:09] "GET /api/filter-options HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:10] "GET /api/policy-mapping HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:10] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:10] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:46] "GET /api/policy-mapping HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:46] "GET /api/filter-options HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:46] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:46] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:57] "GET /api/filter-options HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:57] "GET /api/policy-mapping HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:57] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:29:58] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:30:13] "GET /api/filter-options HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:30:13] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:30:13] "GET /api/policy-mapping HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:30:14] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:30:29] "GET /api/policy-mapping HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:30:29] "GET /api/filter-options HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:30:29] "POST /api/week-comparison HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:30:30] "POST /api/kpi-windows HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:33:20] "GET /api/health HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:33:30] "POST /api/insurance-type-distribution HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:33:35] "POST /api/premium-range-distribution HTTP/1.1" 200 -
127.0.0.1 - - [09/Nov/2025 11:33:40] "POST /api/renewal-type-distribution HTTP/1.1" 200 -
/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/resource_tracker.py:277: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown: {'/mp-aigj_mcd'}
  warnings.warn(
/opt/homebrew/Cellar/python@3.13/3.13.2/Frameworks/Python.framework/Versions/3.13/lib/python3.13/multiprocessing/resource_tracker.py:277: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown: {'/mp-l96bhyzr'}
  warnings.warn(
